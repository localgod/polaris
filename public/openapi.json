{
  "openapi": "3.1.0",
  "info": {
    "title": "Polaris API",
    "version": "2.0.0",
    "description": "# Polaris Technology Catalog API\n\nThe Polaris API provides programmatic access to the technology catalog, enabling automation, integration, and custom tooling.\n\n## Key Features\n\n- **RESTful Design** - Resource-based URLs with proper HTTP methods\n- **Comprehensive Coverage** - Systems, Teams, Technologies, Components, Policies, and more\n- **Developer-Friendly** - Clear error messages and consistent response structure\n\n## Authentication\n\nMost endpoints require authentication using session-based authentication integrated with the web application.\n\n**Authorization Levels:**\n- **Public** - No authentication required\n- **Authenticated** - Valid user session required  \n- **Team Member** - User must belong to a team\n- **Team Owner** - User must belong to team that owns the resource\n- **Superuser** - User must have superuser role\n\n## Response Format\n\nAll successful responses follow this structure:\n```json\n{\n  \"success\": true,\n  \"data\": [...],\n  \"count\": 10\n}\n```\n\nAll errors follow this structure:\n```json\n{\n  \"statusCode\": 404,\n  \"message\": \"Resource 'example' not found\"\n}\n```\n\n## Richardson Maturity Model\n\nThis API implements **RMM Level 2** with proper use of HTTP methods and status codes.",
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    },
    "contact": {
      "name": "Polaris",
      "url": "https://github.com/localgod/polaris"
    }
  },
  "servers": [
    {
      "url": "/api",
      "description": "API Server"
    }
  ],
  "tags": [
    {
      "name": "Health",
      "description": "Health check endpoints"
    },
    {
      "name": "Systems",
      "description": "System management endpoints"
    },
    {
      "name": "Components",
      "description": "Component management endpoints"
    },
    {
      "name": "Technologies",
      "description": "Technology catalog endpoints"
    },
    {
      "name": "Teams",
      "description": "Team management endpoints"
    },
    {
      "name": "Policies",
      "description": "Policy and compliance endpoints"
    },
    {
      "name": "Compliance",
      "description": "Compliance violation and audit endpoints"
    },
    {
      "name": "Repositories",
      "description": "Repository management endpoints"
    },
    {
      "name": "Users",
      "description": "User management endpoints"
    },
    {
      "name": "Approvals",
      "description": "Technology approval endpoints"
    },
    {
      "name": "Admin",
      "description": "Administrative endpoints"
    }
  ],
  "components": {
    "securitySchemes": {
      "sessionAuth": {
        "type": "apiKey",
        "in": "cookie",
        "name": "session",
        "description": "Session-based authentication using HTTP cookies"
      }
    },
    "schemas": {
      "ApiSuccessResponse": {
        "type": "object",
        "required": [
          "success",
          "data",
          "count"
        ],
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [
              true
            ]
          },
          "data": {
            "type": "array",
            "items": {}
          },
          "count": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "ApiSingleResourceResponse": {
        "type": "object",
        "required": [
          "success",
          "data"
        ],
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [
              true
            ]
          },
          "data": {
            "type": "object",
            "description": "Single resource object"
          }
        }
      },
      "ApiErrorResponse": {
        "type": "object",
        "required": [
          "statusCode",
          "statusMessage",
          "message"
        ],
        "properties": {
          "statusCode": {
            "type": "integer",
            "description": "HTTP status code"
          },
          "statusMessage": {
            "type": "string",
            "description": "HTTP status message"
          },
          "message": {
            "type": "string",
            "description": "Error message"
          },
          "url": {
            "type": "string",
            "description": "Request URL"
          },
          "stack": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Error stack trace (development only)"
          }
        }
      },
      "Hash": {
        "type": "object",
        "required": [
          "algorithm",
          "value"
        ],
        "properties": {
          "algorithm": {
            "type": "string",
            "description": "Hash algorithm (SHA256, SHA512, BLAKE3, etc.)",
            "example": "SHA-256"
          },
          "value": {
            "type": "string",
            "description": "Hash value",
            "example": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
          }
        }
      },
      "License": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "nullable": true,
            "description": "SPDX license ID",
            "example": "MIT"
          },
          "name": {
            "type": "string",
            "nullable": true,
            "description": "License name",
            "example": "MIT License"
          },
          "url": {
            "type": "string",
            "nullable": true,
            "description": "License URL",
            "example": "https://opensource.org/licenses/MIT"
          },
          "text": {
            "type": "string",
            "nullable": true,
            "description": "Full license text"
          }
        }
      },
      "ExternalReference": {
        "type": "object",
        "required": [
          "type",
          "url"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Reference type (vcs, website, documentation, issue-tracker, etc.)",
            "example": "vcs"
          },
          "url": {
            "type": "string",
            "description": "Reference URL",
            "example": "https://github.com/facebook/react"
          }
        }
      },
      "Component": {
        "type": "object",
        "required": [
          "name",
          "version"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Component name"
          },
          "version": {
            "type": "string",
            "description": "Component version"
          },
          "packageManager": {
            "type": "string",
            "nullable": true,
            "description": "Package manager (npm, maven, pypi, cargo, etc.)",
            "example": "npm"
          },
          "purl": {
            "type": "string",
            "nullable": true,
            "description": "Package URL",
            "example": "pkg:npm/react@18.2.0"
          },
          "cpe": {
            "type": "string",
            "nullable": true,
            "description": "Common Platform Enumeration"
          },
          "bomRef": {
            "type": "string",
            "nullable": true,
            "description": "Unique identifier within SBOM"
          },
          "type": {
            "type": "string",
            "nullable": true,
            "enum": [
              "application",
              "framework",
              "library",
              "container",
              "platform",
              "operating-system",
              "device",
              "device-driver",
              "firmware",
              "file",
              "machine-learning-model",
              "data"
            ],
            "description": "Component type"
          },
          "group": {
            "type": "string",
            "nullable": true,
            "description": "Maven groupId, npm scope, etc.",
            "example": "@facebook"
          },
          "scope": {
            "type": "string",
            "nullable": true,
            "enum": [
              "required",
              "optional",
              "excluded",
              "dev",
              "test",
              "runtime",
              "provided"
            ],
            "description": "Dependency scope"
          },
          "hashes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Hash"
            },
            "description": "Component hashes"
          },
          "licenses": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/License"
            },
            "description": "Component licenses"
          },
          "copyright": {
            "type": "string",
            "nullable": true,
            "description": "Copyright text"
          },
          "supplier": {
            "type": "string",
            "nullable": true,
            "description": "Organization/person who supplied the component"
          },
          "author": {
            "type": "string",
            "nullable": true,
            "description": "Original author"
          },
          "publisher": {
            "type": "string",
            "nullable": true,
            "description": "Publisher"
          },
          "description": {
            "type": "string",
            "nullable": true,
            "description": "Component description"
          },
          "homepage": {
            "type": "string",
            "nullable": true,
            "description": "Project homepage URL"
          },
          "externalReferences": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExternalReference"
            },
            "description": "External references (VCS, docs, issues, etc.)"
          },
          "releaseDate": {
            "type": "string",
            "nullable": true,
            "format": "date-time",
            "description": "Release date"
          },
          "publishedDate": {
            "type": "string",
            "nullable": true,
            "format": "date-time",
            "description": "When published to registry"
          },
          "modifiedDate": {
            "type": "string",
            "nullable": true,
            "format": "date-time",
            "description": "Last modification date"
          },
          "technologyName": {
            "type": "string",
            "nullable": true,
            "description": "Linked Technology name"
          },
          "systemCount": {
            "type": "integer",
            "description": "Number of systems using this component"
          }
        }
      },
      "UnmappedComponent": {
        "type": "object",
        "required": [
          "name",
          "version"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Component name"
          },
          "version": {
            "type": "string",
            "description": "Component version"
          },
          "packageManager": {
            "type": "string",
            "nullable": true,
            "description": "Package manager (npm, maven, pypi, cargo, etc.)"
          },
          "purl": {
            "type": "string",
            "nullable": true,
            "description": "Package URL"
          },
          "cpe": {
            "type": "string",
            "nullable": true,
            "description": "Common Platform Enumeration"
          },
          "type": {
            "type": "string",
            "nullable": true,
            "enum": [
              "application",
              "framework",
              "library",
              "container",
              "platform",
              "operating-system",
              "device",
              "device-driver",
              "firmware",
              "file",
              "machine-learning-model",
              "data"
            ],
            "description": "Component type"
          },
          "group": {
            "type": "string",
            "nullable": true,
            "description": "Maven groupId, npm scope, etc."
          },
          "hashes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Hash"
            },
            "description": "Component hashes"
          },
          "licenses": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/License"
            },
            "description": "Component licenses"
          },
          "systems": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Systems using this component"
          },
          "systemCount": {
            "type": "integer",
            "description": "Number of systems using this component"
          }
        }
      },
      "Technology": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "category": {
            "type": "string"
          },
          "vendor": {
            "type": "string",
            "nullable": true
          },
          "lastReviewed": {
            "type": "string",
            "nullable": true
          },
          "ownerTeamName": {
            "type": "string",
            "nullable": true
          },
          "versions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "approvals": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TechnologyApproval"
            }
          }
        }
      },
      "TechnologyApproval": {
        "type": "object",
        "properties": {
          "team": {
            "type": "string"
          },
          "time": {
            "type": "string"
          },
          "approvedAt": {
            "type": "string"
          },
          "deprecatedAt": {
            "type": "string"
          },
          "eolDate": {
            "type": "string"
          },
          "migrationTarget": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          },
          "approvedBy": {
            "type": "string"
          },
          "versionConstraint": {
            "type": "string"
          }
        }
      },
      "System": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "domain": {
            "type": "string",
            "nullable": true
          },
          "ownerTeam": {
            "type": "string",
            "nullable": true
          },
          "businessCriticality": {
            "type": "string",
            "enum": [
              "critical",
              "high",
              "medium",
              "low"
            ],
            "nullable": true
          },
          "environment": {
            "type": "string",
            "enum": [
              "dev",
              "test",
              "staging",
              "prod"
            ],
            "nullable": true
          },
          "componentCount": {
            "type": "integer"
          },
          "repositoryCount": {
            "type": "integer"
          }
        }
      },
      "Repository": {
        "type": "object",
        "properties": {
          "url": {
            "type": "string"
          },
          "scmType": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "isPublic": {
            "type": "boolean"
          },
          "requiresAuth": {
            "type": "boolean"
          },
          "defaultBranch": {
            "type": "string",
            "nullable": true
          },
          "createdAt": {
            "type": "string",
            "nullable": true
          },
          "lastSyncedAt": {
            "type": "string",
            "nullable": true
          },
          "systemCount": {
            "type": "integer"
          }
        }
      },
      "Team": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "email": {
            "type": "string",
            "nullable": true
          },
          "responsibilityArea": {
            "type": "string",
            "nullable": true
          },
          "technologyCount": {
            "type": "integer"
          },
          "systemCount": {
            "type": "integer"
          }
        }
      },
      "Policy": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "ruleType": {
            "type": "string"
          },
          "severity": {
            "type": "string"
          },
          "effectiveDate": {
            "type": "string",
            "nullable": true
          },
          "expiryDate": {
            "type": "string",
            "nullable": true
          },
          "enforcedBy": {
            "type": "string"
          },
          "scope": {
            "type": "string"
          },
          "status": {
            "type": "string"
          },
          "enforcerTeam": {
            "type": "string",
            "nullable": true
          },
          "subjectTeams": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "governedTechnologies": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "technologyCount": {
            "type": "integer"
          }
        }
      },
      "Violation": {
        "type": "object",
        "properties": {
          "violationId": {
            "type": "string"
          },
          "policyName": {
            "type": "string"
          },
          "systemName": {
            "type": "string"
          },
          "componentName": {
            "type": "string"
          },
          "componentVersion": {
            "type": "string"
          },
          "severity": {
            "type": "string"
          },
          "detectedAt": {
            "type": "string"
          },
          "status": {
            "type": "string"
          },
          "resolvedAt": {
            "type": "string",
            "nullable": true
          },
          "notes": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "role": {
            "type": "string"
          },
          "provider": {
            "type": "string"
          },
          "avatarUrl": {
            "type": "string",
            "nullable": true
          },
          "lastLogin": {
            "type": "string",
            "nullable": true
          },
          "createdAt": {
            "type": "string",
            "nullable": true
          },
          "teams": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy"
            ]
          },
          "database": {
            "type": "string"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "error": {
            "type": "string"
          }
        }
      }
    }
  },
  "paths": {
    "/admin/import/github": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Import a system from a GitHub repository",
        "description": "Fetches repository metadata and dependency manifests from the GitHub API,\ngenerates an SBOM via cdxgen, creates the system with its repository,\nand ingests the SBOM. Superuser only.\n",
        "security": [
          {
            "session": []
          },
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "repositoryUrl"
                ],
                "properties": {
                  "repositoryUrl": {
                    "type": "string",
                    "description": "GitHub repo URL or owner/repo shorthand",
                    "example": "https://github.com/org/repo"
                  },
                  "domain": {
                    "type": "string",
                    "description": "Business domain (defaults to Development)"
                  },
                  "ownerTeam": {
                    "type": "string",
                    "description": "Owning team name"
                  },
                  "businessCriticality": {
                    "type": "string",
                    "enum": [
                      "critical",
                      "high",
                      "medium",
                      "low"
                    ]
                  },
                  "environment": {
                    "type": "string",
                    "enum": [
                      "dev",
                      "test",
                      "staging",
                      "prod"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "System imported successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "403": {
            "description": "Not authorized"
          },
          "422": {
            "description": "GitHub repository not accessible or no manifests found"
          }
        }
      }
    },
    "/admin/licenses/whitelist": {
      "get": {
        "tags": [
          "Admin",
          "Licenses"
        ],
        "summary": "Get license whitelist management data",
        "description": "Retrieves all licenses with whitelist status for superadmin management.\nIncludes filtering and search capabilities.\n\n**Authorization:** Superuser only\n",
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "category",
            "schema": {
              "type": "string",
              "enum": [
                "permissive",
                "copyleft",
                "proprietary",
                "public-domain",
                "other"
              ]
            },
            "description": "Filter by license category"
          },
          {
            "in": "query",
            "name": "osiApproved",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter by OSI approval status"
          },
          {
            "in": "query",
            "name": "whitelisted",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter by whitelist status"
          },
          {
            "in": "query",
            "name": "search",
            "schema": {
              "type": "string"
            },
            "description": "Search by license ID or name"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "License whitelist data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "allOf": [
                          {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              },
                              "category": {
                                "type": "string"
                              },
                              "osiApproved": {
                                "type": "boolean"
                              },
                              "whitelisted": {
                                "type": "boolean"
                              },
                              "componentCount": {
                                "type": "integer"
                              }
                            }
                          }
                        ]
                      }
                    },
                    "count": {
                      "type": "integer"
                    },
                    "total": {
                      "type": "integer"
                    },
                    "statistics": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "integer"
                        },
                        "whitelisted": {
                          "type": "integer"
                        },
                        "byCategory": {
                          "type": "object"
                        }
                      }
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": [
                    {
                      "id": "MIT",
                      "name": "MIT License",
                      "category": "permissive",
                      "osiApproved": true,
                      "whitelisted": true,
                      "componentCount": 42
                    }
                  ],
                  "count": 1,
                  "total": 1,
                  "statistics": {
                    "total": 25,
                    "whitelisted": 8
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Superuser access required"
          }
        }
      },
      "put": {
        "tags": [
          "Admin",
          "Licenses"
        ],
        "summary": "Update license whitelist status",
        "description": "Updates whitelist status for one or multiple licenses.\nSupports both single license and bulk operations.\n\n**Authorization:** Superuser only\n",
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "licenseId": {
                    "type": "string",
                    "description": "Single license ID (for single update)"
                  },
                  "licenseIds": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Multiple license IDs (for bulk update)"
                  },
                  "whitelisted": {
                    "type": "boolean",
                    "description": "New whitelist status"
                  }
                },
                "required": [
                  "whitelisted"
                ],
                "example": {
                  "licenseId": "MIT",
                  "whitelisted": true
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Whitelist status updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    },
                    "updated": {
                      "type": "integer",
                      "description": "Number of licenses updated"
                    }
                  }
                },
                "example": {
                  "success": true,
                  "message": "License whitelist status updated successfully",
                  "updated": 1
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body or missing license data"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Superuser access required"
          },
          "404": {
            "description": "License not found"
          }
        }
      }
    },
    "/admin/users/{userId}": {
      "delete": {
        "tags": [
          "Admin"
        ],
        "summary": "Delete a technical user",
        "description": "Deletes a technical user and all associated tokens. Superuser only.",
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User deleted"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },
    "/admin/users/{userId}/teams": {
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Assign user to teams",
        "description": "Assigns a user to one or more teams, replacing existing team memberships.\n\n**Authorization:** Superuser\n\n**Behavior:**\n- Removes all existing team memberships\n- Creates new memberships for specified teams\n- Optionally grants team management permissions\n",
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "teams"
                ],
                "properties": {
                  "teams": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Array of team names"
                  },
                  "canManage": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Array of team names user can manage (optional)"
                  }
                }
              },
              "example": {
                "teams": [
                  "frontend-team",
                  "platform-team"
                ],
                "canManage": [
                  "frontend-team"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User teams updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        },
                        "teams": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "email": {
                                "type": "string"
                              }
                            }
                          }
                        },
                        "canManage": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "User ID or teams array is required"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Superuser access required"
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },
    "/admin/users/{userId}/tokens": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "List API tokens for a user",
        "description": "Returns all tokens for the specified user (without hashes). Superuser only.",
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tokens listed"
          }
        }
      },
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Generate an API token for a technical user",
        "description": "Creates a new API token for the specified technical user.\nThe plaintext token is returned only once in the response.\nSuperuser only.\n",
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "description": {
                    "type": "string"
                  },
                  "expiresInDays": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Token created"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },
    "/admin/users/{userId}/tokens/{tokenId}": {
      "delete": {
        "tags": [
          "Admin"
        ],
        "summary": "Revoke an API token",
        "description": "Revokes the specified API token. Superuser only.",
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "tokenId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Token revoked"
          },
          "404": {
            "description": "Token not found"
          }
        }
      }
    },
    "/admin/users": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "List all users",
        "description": "Retrieves all users with their team memberships and management permissions.\n\n**Authorization:** Superuser\n",
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Users retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "allOf": [
                          {
                            "$ref": "#/components/schemas/User"
                          },
                          {
                            "type": "object",
                            "properties": {
                              "teams": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "email": {
                                      "type": "string"
                                    }
                                  }
                                }
                              },
                              "canManage": {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        ]
                      }
                    },
                    "count": {
                      "type": "integer"
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": [
                    {
                      "id": "user123",
                      "name": "John Doe",
                      "email": "john@example.com",
                      "teams": [
                        {
                          "name": "frontend-team",
                          "email": "frontend@example.com"
                        }
                      ],
                      "canManage": [
                        "frontend-team"
                      ]
                    }
                  ],
                  "count": 1
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Superuser access required"
          }
        }
      },
      "post": {
        "tags": [
          "Admin"
        ],
        "summary": "Create a technical user",
        "description": "Creates a non-OAuth technical user for API access. Superuser only.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "email"
                ],
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Technical user created"
          },
          "400": {
            "description": "Invalid input"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/approvals": {
      "get": {
        "tags": [
          "Approvals"
        ],
        "summary": "Check technology approval status",
        "description": "Checks if a technology (and optionally a specific version) is approved for a team.\n\n**Approval Hierarchy:**\n1. Version-specific approval (highest priority) - `level: \"version\"`\n2. Technology-level approval - `level: \"technology\"`\n3. Default (not approved) - `level: \"default\"`, `time: \"eliminate\"`\n\n**TIME Framework Values:**\n- `adopt` - Recommended for use\n- `trial` - Experimental use allowed\n- `assess` - Under evaluation\n- `hold` - Do not use for new projects\n- `eliminate` - Must be removed\n",
        "parameters": [
          {
            "in": "query",
            "name": "team",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Team name",
            "example": "frontend-team"
          },
          {
            "in": "query",
            "name": "technology",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Technology name",
            "example": "react"
          },
          {
            "in": "query",
            "name": "version",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Specific version to check",
            "example": "18.2.0"
          }
        ],
        "responses": {
          "200": {
            "description": "Approval status retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSingleResourceResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "object",
                          "properties": {
                            "team": {
                              "type": "string"
                            },
                            "technology": {
                              "type": "string"
                            },
                            "category": {
                              "type": "string"
                            },
                            "vendor": {
                              "type": "string"
                            },
                            "version": {
                              "type": "string"
                            },
                            "approval": {
                              "type": "object",
                              "properties": {
                                "level": {
                                  "type": "string",
                                  "enum": [
                                    "version",
                                    "technology",
                                    "default"
                                  ]
                                },
                                "time": {
                                  "type": "string",
                                  "enum": [
                                    "adopt",
                                    "trial",
                                    "assess",
                                    "hold",
                                    "eliminate"
                                  ]
                                },
                                "approvedAt": {
                                  "type": "string"
                                },
                                "approvedBy": {
                                  "type": "string"
                                },
                                "notes": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": {
                    "team": "frontend-team",
                    "technology": "react",
                    "category": "framework",
                    "vendor": "Meta",
                    "version": "18.2.0",
                    "approval": {
                      "level": "version",
                      "time": "adopt",
                      "approvedAt": "2024-01-15T10:00:00Z",
                      "approvedBy": "architecture-team",
                      "notes": "Approved for production use"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Team and technology parameters are required"
          },
          "404": {
            "description": "Team or technology not found"
          }
        }
      }
    },
    "/audit-logs": {
      "get": {
        "tags": [
          "Audit"
        ],
        "summary": "Get audit logs",
        "description": "Retrieves audit log entries with optional filtering.\nReturns the most recent entries first.\n",
        "parameters": [
          {
            "in": "query",
            "name": "entityType",
            "schema": {
              "type": "string"
            },
            "description": "Filter by entity type (e.g., Policy, Technology)"
          },
          {
            "in": "query",
            "name": "operation",
            "schema": {
              "type": "string"
            },
            "description": "Filter by operation (e.g., ACTIVATE, DEACTIVATE, CREATE)"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 100
            },
            "description": "Maximum number of entries to return"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Number of entries to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "Audit logs retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "timestamp": {
                            "type": "string"
                          },
                          "operation": {
                            "type": "string"
                          },
                          "entityType": {
                            "type": "string"
                          },
                          "entityId": {
                            "type": "string"
                          },
                          "reason": {
                            "type": "string"
                          }
                        }
                      }
                    },
                    "count": {
                      "type": "integer"
                    },
                    "filters": {
                      "type": "object",
                      "properties": {
                        "entityTypes": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        },
                        "operations": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/auth/{provider}": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "OAuth authentication endpoints",
        "description": "NextAuth.js authentication endpoints for OAuth providers.\n\n**Available Providers:**\n- GitHub OAuth\n\n**Endpoints:**\n- `GET /api/auth/signin` - Sign in page\n- `GET /api/auth/signout` - Sign out\n- `GET /api/auth/callback/{provider}` - OAuth callback\n- `GET /api/auth/session` - Get current session\n- `GET /api/auth/csrf` - Get CSRF token\n- `GET /api/auth/providers` - List available providers\n\n**Authorization Levels:**\n- `user` - Default role for authenticated users\n- `superuser` - Admin role (configured via SUPERUSER_EMAILS env var)\n",
        "parameters": [
          {
            "in": "path",
            "name": "provider",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "OAuth provider name (e.g., \"github\")"
          }
        ],
        "responses": {
          "200": {
            "description": "Authentication response"
          },
          "302": {
            "description": "Redirect to OAuth provider or callback"
          }
        }
      }
    },
    "/compliance/violations": {
      "get": {
        "tags": [
          "Compliance"
        ],
        "summary": "Get compliance violations",
        "description": "Retrieves all compliance violations across the organization.\n\nA compliance violation occurs when:\n- A team uses a technology without approval (unapproved)\n- A team uses a technology marked for elimination (eliminated)\n\nResults include affected systems and migration targets where applicable.\n",
        "responses": {
          "200": {
            "description": "Compliance violations retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSingleResourceResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "object",
                          "properties": {
                            "violations": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "team": {
                                    "type": "string"
                                  },
                                  "technology": {
                                    "type": "string"
                                  },
                                  "category": {
                                    "type": "string"
                                  },
                                  "systemCount": {
                                    "type": "integer"
                                  },
                                  "systems": {
                                    "type": "array",
                                    "items": {
                                      "type": "string"
                                    }
                                  },
                                  "violationType": {
                                    "type": "string",
                                    "enum": [
                                      "unapproved",
                                      "eliminated"
                                    ]
                                  },
                                  "notes": {
                                    "type": "string",
                                    "nullable": true
                                  },
                                  "migrationTarget": {
                                    "type": "string",
                                    "nullable": true
                                  }
                                }
                              }
                            },
                            "summary": {
                              "type": "object",
                              "properties": {
                                "totalViolations": {
                                  "type": "integer"
                                },
                                "teamsAffected": {
                                  "type": "integer"
                                },
                                "byTeam": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "team": {
                                        "type": "string"
                                      },
                                      "violationCount": {
                                        "type": "integer"
                                      },
                                      "systemsAffected": {
                                        "type": "integer"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": {
                    "violations": [
                      {
                        "team": "frontend-team",
                        "technology": "jQuery",
                        "category": "library",
                        "systemCount": 3,
                        "systems": [
                          "web-portal",
                          "admin-dashboard"
                        ],
                        "violationType": "eliminated",
                        "notes": "Migrate to modern framework",
                        "migrationTarget": "React"
                      }
                    ],
                    "summary": {
                      "totalViolations": 1,
                      "teamsAffected": 1,
                      "byTeam": [
                        {
                          "team": "frontend-team",
                          "violationCount": 1,
                          "systemsAffected": 3
                        }
                      ]
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch compliance violations"
          }
        }
      }
    },
    "/components": {
      "get": {
        "tags": [
          "Components"
        ],
        "summary": "List all components",
        "description": "Retrieves a list of components with their metadata and system usage counts. Supports filtering and pagination.",
        "parameters": [
          {
            "in": "query",
            "name": "search",
            "schema": {
              "type": "string"
            },
            "description": "Search by component name, group, or package URL (case-insensitive)"
          },
          {
            "in": "query",
            "name": "packageManager",
            "schema": {
              "type": "string"
            },
            "description": "Filter by package manager (e.g., npm, maven, pypi, nuget, cargo)"
          },
          {
            "in": "query",
            "name": "type",
            "schema": {
              "type": "string"
            },
            "description": "Filter by component type (e.g., library, framework, application)"
          },
          {
            "in": "query",
            "name": "technology",
            "schema": {
              "type": "string"
            },
            "description": "Filter by mapped technology name"
          },
          {
            "in": "query",
            "name": "license",
            "schema": {
              "type": "string"
            },
            "description": "Filter by license SPDX ID (e.g., MIT, Apache-2.0)"
          },
          {
            "in": "query",
            "name": "hasLicense",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter by license presence (ignored when license is also specified)"
          },
          {
            "in": "query",
            "name": "system",
            "schema": {
              "type": "string"
            },
            "description": "Filter by system name (only components used by this system)"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50,
              "minimum": 1,
              "maximum": 200
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0,
              "minimum": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved components",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Component"
                          }
                        },
                        "total": {
                          "type": "integer",
                          "description": "Total count of components matching filters (without pagination)"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Invalid query parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch components",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/components/unmapped": {
      "get": {
        "tags": [
          "Components"
        ],
        "summary": "Get all unmapped components",
        "description": "Retrieves all components across all systems that are not mapped to a known technology.\n\nResults are ordered by system count (most used first) to help prioritize mapping efforts.\n\n**Use Cases:**\n- Identify components that need technology mapping\n- Find widely-used internal libraries\n- Discover shadow IT or unapproved dependencies\n",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50,
              "minimum": 1,
              "maximum": 200
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0,
              "minimum": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Unmapped components retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "allOf": [
                          {
                            "$ref": "#/components/schemas/UnmappedComponent"
                          },
                          {
                            "type": "object",
                            "properties": {
                              "systems": {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                }
                              },
                              "systemCount": {
                                "type": "integer"
                              }
                            }
                          }
                        ]
                      }
                    },
                    "count": {
                      "type": "integer",
                      "description": "Number of items in current page"
                    },
                    "total": {
                      "type": "integer",
                      "description": "Total number of unmapped components"
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": [
                    {
                      "name": "@company/internal-ui",
                      "version": "2.1.0",
                      "packageManager": "npm",
                      "license": "proprietary",
                      "systems": [
                        "web-portal",
                        "admin-dashboard",
                        "mobile-api"
                      ],
                      "systemCount": 3
                    }
                  ],
                  "count": 1,
                  "total": 1
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch unmapped components"
          }
        }
      }
    },
    "/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health check endpoint",
        "description": "Checks the health of the API and database connectivity",
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                },
                "example": {
                  "status": "healthy",
                  "database": "connected",
                  "timestamp": "2025-10-30T13:00:00.000Z"
                }
              }
            }
          },
          "503": {
            "description": "Service is unhealthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                },
                "example": {
                  "status": "unhealthy",
                  "database": "disconnected",
                  "error": "Database connection failed",
                  "timestamp": "2025-10-30T13:00:00.000Z"
                }
              }
            }
          }
        }
      }
    },
    "/licenses": {
      "get": {
        "tags": [
          "Licenses",
          "License Compliance"
        ],
        "summary": "List all licenses",
        "description": "Retrieves a list of all licenses discovered in components with usage statistics",
        "parameters": [
          {
            "in": "query",
            "name": "category",
            "schema": {
              "type": "string",
              "enum": [
                "permissive",
                "copyleft",
                "proprietary",
                "public-domain",
                "other"
              ]
            },
            "description": "Filter by license category"
          },
          {
            "in": "query",
            "name": "osiApproved",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter by OSI approval status"
          },
          {
            "in": "query",
            "name": "deprecated",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter by deprecated status"
          },
          {
            "in": "query",
            "name": "search",
            "schema": {
              "type": "string"
            },
            "description": "Search by license ID or name"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved licenses",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "SPDX identifier"
                              },
                              "name": {
                                "type": "string",
                                "description": "Human-readable name"
                              },
                              "spdxId": {
                                "type": "string",
                                "description": "Canonical SPDX identifier"
                              },
                              "osiApproved": {
                                "type": "boolean",
                                "description": "OSI approval status"
                              },
                              "url": {
                                "type": "string",
                                "description": "License text URL"
                              },
                              "category": {
                                "type": "string",
                                "description": "License category"
                              },
                              "deprecated": {
                                "type": "boolean",
                                "description": "Whether license is deprecated"
                              },
                              "componentCount": {
                                "type": "integer",
                                "description": "Number of components using this license"
                              }
                            }
                          }
                        },
                        "total": {
                          "type": "integer",
                          "description": "Total number of licenses"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch licenses",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/licenses/{id}": {
      "get": {
        "tags": [
          "Licenses",
          "License Compliance"
        ],
        "summary": "Get license details",
        "description": "Retrieves detailed information about a specific license including\nusage statistics and full license text from the SPDX license list.\n",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "License ID (SPDX identifier)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved license",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              },
                              "spdxId": {
                                "type": "string"
                              },
                              "osiApproved": {
                                "type": "boolean"
                              },
                              "url": {
                                "type": "string"
                              },
                              "category": {
                                "type": "string"
                              },
                              "licenseText": {
                                "type": "string"
                              },
                              "deprecated": {
                                "type": "boolean"
                              },
                              "componentCount": {
                                "type": "integer"
                              }
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "License not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch license",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/licenses/{id}/allow": {
      "post": {
        "tags": [
          "Licenses"
        ],
        "summary": "Allow a previously denied license",
        "description": "Removes a license from the organization's denied licenses list.\n\nComponents using this license will no longer appear as violations\n(unless denied by another policy).\n",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "License ID (e.g., MIT, Apache-2.0)"
          }
        ],
        "responses": {
          "200": {
            "description": "License allowed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    },
                    "removed": {
                      "type": "boolean",
                      "description": "Whether the license was removed (false if wasn't denied)"
                    },
                    "deniedLicenses": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "License ID is required"
          }
        }
      }
    },
    "/licenses/{id}/components": {
      "get": {
        "tags": [
          "Licenses"
        ],
        "summary": "List components using a license",
        "description": "Returns paginated list of components that use the specified license",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "License ID (SPDX identifier)"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            }
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Components retrieved successfully"
          }
        }
      }
    },
    "/licenses/{id}/deny": {
      "post": {
        "tags": [
          "Licenses"
        ],
        "summary": "Deny a license organization-wide",
        "description": "Adds a license to the organization's denied licenses list.\nCreates the \"Organization License Policy\" if it doesn't exist.\n\nOnce denied, any component using this license will appear as a violation.\n",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "License ID (e.g., MIT, Apache-2.0)"
          }
        ],
        "responses": {
          "200": {
            "description": "License denied successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    },
                    "added": {
                      "type": "boolean",
                      "description": "Whether the license was newly added (false if already denied)"
                    },
                    "deniedLicenses": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "License ID is required"
          },
          "404": {
            "description": "License not found"
          }
        }
      }
    },
    "/licenses/denied": {
      "get": {
        "tags": [
          "Licenses"
        ],
        "summary": "Get list of denied license IDs",
        "description": "Returns the list of license IDs that are denied by the\nOrganization License Policy.\n",
        "responses": {
          "200": {
            "description": "Denied licenses retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "deniedLicenses": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/licenses/statistics": {
      "get": {
        "tags": [
          "Licenses",
          "License Compliance"
        ],
        "summary": "Get license statistics",
        "description": "Retrieves organization-wide license statistics including counts by category, OSI approval, and deprecation status",
        "responses": {
          "200": {
            "description": "Successfully retrieved license statistics",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "total": {
                            "type": "integer",
                            "description": "Total number of unique licenses"
                          },
                          "byCategory": {
                            "type": "object",
                            "description": "License count by category",
                            "properties": {
                              "permissive": {
                                "type": "integer"
                              },
                              "copyleft": {
                                "type": "integer"
                              },
                              "proprietary": {
                                "type": "integer"
                              },
                              "public-domain": {
                                "type": "integer"
                              },
                              "other": {
                                "type": "integer"
                              }
                            }
                          },
                          "osiApproved": {
                            "type": "integer",
                            "description": "Number of OSI-approved licenses"
                          },
                          "deprecated": {
                            "type": "integer",
                            "description": "Number of deprecated licenses"
                          }
                        }
                      }
                    },
                    "count": {
                      "type": "integer",
                      "example": 1
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch license statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/policies": {
      "get": {
        "tags": [
          "Policies"
        ],
        "summary": "List all policies",
        "description": "Retrieves a list of all policies with optional filtering",
        "parameters": [
          {
            "in": "query",
            "name": "scope",
            "schema": {
              "type": "string"
            },
            "description": "Filter by policy scope"
          },
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string"
            },
            "description": "Filter by policy status"
          },
          {
            "in": "query",
            "name": "enforcedBy",
            "schema": {
              "type": "string"
            },
            "description": "Filter by enforcement mechanism"
          },
          {
            "in": "query",
            "name": "ruleType",
            "schema": {
              "type": "string",
              "enum": [
                "technology-approval",
                "license-compliance"
              ]
            },
            "description": "Filter by policy rule type"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved policies",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Policy"
                          }
                        },
                        "total": {
                          "type": "integer",
                          "description": "Total number of policies"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch policies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Policies"
        ],
        "summary": "Create a new policy",
        "description": "Creates a new policy for governance enforcement.\n\nFor license-compliance policies, you must specify:\n- `licenseMode`: Either 'allowlist' or 'denylist'\n- `allowedLicenses` or `deniedLicenses`: Array of license IDs\n\nOrganization-scope policies automatically create SUBJECT_TO relationships\nwith all teams.\n",
        "security": [
          {
            "session": []
          },
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "ruleType",
                  "severity"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Unique policy name",
                    "example": "Prohibit MIT License"
                  },
                  "description": {
                    "type": "string",
                    "description": "Policy description",
                    "example": "MIT license is not allowed due to legal requirements"
                  },
                  "ruleType": {
                    "type": "string",
                    "enum": [
                      "approval",
                      "compliance",
                      "security",
                      "license-compliance"
                    ],
                    "description": "Type of policy rule",
                    "example": "license-compliance"
                  },
                  "severity": {
                    "type": "string",
                    "enum": [
                      "critical",
                      "error",
                      "warning",
                      "info"
                    ],
                    "description": "Severity level for violations",
                    "example": "error"
                  },
                  "scope": {
                    "type": "string",
                    "enum": [
                      "organization",
                      "team"
                    ],
                    "default": "organization",
                    "description": "Policy scope"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "active",
                      "draft",
                      "archived"
                    ],
                    "default": "active",
                    "description": "Policy status"
                  },
                  "enforcedBy": {
                    "type": "string",
                    "description": "Team responsible for enforcement",
                    "example": "Security"
                  },
                  "licenseMode": {
                    "type": "string",
                    "enum": [
                      "allowlist",
                      "denylist"
                    ],
                    "description": "Required for license-compliance policies",
                    "example": "denylist"
                  },
                  "allowedLicenses": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "License IDs to allow (for allowlist mode)",
                    "example": [
                      "Apache-2.0",
                      "BSD-3-Clause"
                    ]
                  },
                  "deniedLicenses": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "License IDs to deny (for denylist mode)",
                    "example": [
                      "MIT",
                      "MIT/X11"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Policy created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Policy created successfully"
                    },
                    "policy": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "ruleType": {
                          "type": "string"
                        },
                        "severity": {
                          "type": "string"
                        },
                        "status": {
                          "type": "string"
                        },
                        "licenseMode": {
                          "type": "string"
                        }
                      }
                    },
                    "relationshipsCreated": {
                      "type": "integer",
                      "example": 7
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - validation failed"
          },
          "401": {
            "description": "Unauthorized - authentication required"
          },
          "409": {
            "description": "Conflict - policy already exists"
          }
        }
      }
    },
    "/policies/{name}": {
      "delete": {
        "tags": [
          "Policies"
        ],
        "summary": "Delete a policy",
        "description": "Deletes a policy and all its relationships.\nRequires superuser access or policy creator.\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Policy name"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "responses": {
          "204": {
            "description": "Policy deleted successfully"
          },
          "400": {
            "description": "Policy name is required"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Superuser access required"
          },
          "404": {
            "description": "Policy not found"
          }
        }
      },
      "get": {
        "tags": [
          "Policies"
        ],
        "summary": "Get policy details",
        "description": "Retrieves detailed information about a specific policy including:\n- Policy metadata and rules\n- Enforcing team\n- Teams subject to the policy\n- Technologies and versions governed by the policy\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Policy name",
            "example": "react-version-policy"
          }
        ],
        "responses": {
          "200": {
            "description": "Policy details retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSingleResourceResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "allOf": [
                            {
                              "$ref": "#/components/schemas/Policy"
                            },
                            {
                              "type": "object",
                              "properties": {
                                "governedVersions": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "technology": {
                                        "type": "string"
                                      },
                                      "version": {
                                        "type": "string"
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": {
                    "name": "react-version-policy",
                    "description": "All React versions must be 18.x or higher",
                    "ruleType": "version-constraint",
                    "severity": "high",
                    "status": "active",
                    "enforcerTeam": "frontend-platform",
                    "subjectTeams": [
                      "frontend-team",
                      "mobile-team"
                    ],
                    "governedTechnologies": [
                      "React"
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "description": "Policy name is required"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Failed to fetch policy"
          }
        }
      },
      "patch": {
        "tags": [
          "Policies"
        ],
        "summary": "Update a policy",
        "description": "Updates a policy's status or other properties.\n\nStatus values:\n- `active`: Policy is enforced, violations are detected\n- `draft`: Policy exists but is not enforced\n- `archived`: Policy is disabled and hidden from active views\n\nRequires superuser access or policy creator.\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Policy name"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "active",
                      "draft",
                      "archived"
                    ],
                    "description": "New policy status"
                  },
                  "reason": {
                    "type": "string",
                    "description": "Reason for the status change (recommended when disabling)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Policy updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    },
                    "policy": {
                      "type": "object"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "404": {
            "description": "Policy not found"
          }
        }
      }
    },
    "/policies/license-violations": {
      "get": {
        "tags": [
          "Policies",
          "License Compliance"
        ],
        "summary": "Get license compliance violations",
        "description": "Retrieves all license compliance violations with optional filtering. Returns components using licenses not allowed by active license compliance policies.",
        "parameters": [
          {
            "in": "query",
            "name": "severity",
            "schema": {
              "type": "string",
              "enum": [
                "critical",
                "error",
                "warning",
                "info"
              ]
            },
            "description": "Filter by violation severity"
          },
          {
            "in": "query",
            "name": "team",
            "schema": {
              "type": "string"
            },
            "description": "Filter by team name"
          },
          {
            "in": "query",
            "name": "system",
            "schema": {
              "type": "string"
            },
            "description": "Filter by system name"
          },
          {
            "in": "query",
            "name": "license",
            "schema": {
              "type": "string"
            },
            "description": "Filter by license ID (SPDX identifier)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved license violations",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "team": {
                            "type": "string",
                            "description": "Team name"
                          },
                          "system": {
                            "type": "string",
                            "description": "System name"
                          },
                          "component": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "version": {
                                "type": "string"
                              },
                              "purl": {
                                "type": "string"
                              }
                            }
                          },
                          "license": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              },
                              "category": {
                                "type": "string"
                              },
                              "osiApproved": {
                                "type": "boolean"
                              }
                            }
                          },
                          "policy": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "description": {
                                "type": "string"
                              },
                              "severity": {
                                "type": "string"
                              },
                              "ruleType": {
                                "type": "string"
                              },
                              "enforcedBy": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    },
                    "count": {
                      "type": "integer",
                      "description": "Number of violations returned"
                    },
                    "summary": {
                      "type": "object",
                      "description": "Violation count by severity",
                      "properties": {
                        "critical": {
                          "type": "integer"
                        },
                        "error": {
                          "type": "integer"
                        },
                        "warning": {
                          "type": "integer"
                        },
                        "info": {
                          "type": "integer"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid filter parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch license violations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/policies/violations": {
      "get": {
        "tags": [
          "Policies"
        ],
        "summary": "Get policy violations",
        "description": "Retrieves all policy violations across the organization.\n\nA violation occurs when:\n- A team uses a technology (USES relationship)\n- The team does not have approval for that technology (no APPROVES relationship)\n- An active policy governs that technology\n- The team is subject to that policy\n\nResults are ordered by severity (critical first) then by team and technology name.\n",
        "parameters": [
          {
            "in": "query",
            "name": "severity",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "critical",
                "error",
                "warning",
                "info"
              ]
            },
            "description": "Filter by policy severity"
          },
          {
            "in": "query",
            "name": "team",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Filter by team name"
          },
          {
            "in": "query",
            "name": "technology",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Filter by technology name"
          }
        ],
        "responses": {
          "200": {
            "description": "Policy violations retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "team": {
                            "type": "string"
                          },
                          "technology": {
                            "type": "string"
                          },
                          "technologyCategory": {
                            "type": "string"
                          },
                          "policy": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "description": {
                                "type": "string"
                              },
                              "severity": {
                                "type": "string"
                              },
                              "ruleType": {
                                "type": "string"
                              },
                              "enforcedBy": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    },
                    "count": {
                      "type": "integer"
                    },
                    "summary": {
                      "type": "object",
                      "properties": {
                        "critical": {
                          "type": "integer"
                        },
                        "error": {
                          "type": "integer"
                        },
                        "warning": {
                          "type": "integer"
                        },
                        "info": {
                          "type": "integer"
                        }
                      }
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": [
                    {
                      "team": "frontend-team",
                      "technology": "jQuery",
                      "technologyCategory": "library",
                      "policy": {
                        "name": "deprecated-libraries",
                        "description": "Deprecated libraries must not be used",
                        "severity": "error",
                        "ruleType": "deprecation",
                        "enforcedBy": "architecture-team"
                      }
                    }
                  ],
                  "count": 1,
                  "summary": {
                    "critical": 0,
                    "error": 1,
                    "warning": 0,
                    "info": 0
                  }
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch policy violations"
          }
        }
      }
    },
    "/repositories": {
      "get": {
        "tags": [
          "Repositories"
        ],
        "summary": "List all repositories",
        "description": "Retrieves a list of all repositories with their metadata and system counts",
        "responses": {
          "200": {
            "description": "Successfully retrieved repositories",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Repository"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch repositories",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/sboms": {
      "post": {
        "tags": [
          "SBOM"
        ],
        "summary": "Validate and submit an SBOM",
        "description": "Validates a Software Bill of Materials (SBOM) in CycloneDX or SPDX format.\nRequires authentication via session or API token.\n",
        "security": [
          {
            "session": []
          },
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "repositoryUrl",
                  "sbom"
                ],
                "properties": {
                  "repositoryUrl": {
                    "type": "string",
                    "format": "uri",
                    "description": "URL to the SCM repository that produced this SBOM",
                    "example": "https://github.com/org/repo"
                  },
                  "sbom": {
                    "type": "object",
                    "description": "The SBOM document in CycloneDX or SPDX format"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SBOM processed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "format": {
                      "type": "string",
                      "enum": [
                        "cyclonedx",
                        "spdx"
                      ]
                    },
                    "message": {
                      "type": "string",
                      "example": "SBOM processed successfully"
                    },
                    "systemName": {
                      "type": "string",
                      "example": "my-application"
                    },
                    "componentsAdded": {
                      "type": "integer",
                      "example": 42
                    },
                    "componentsUpdated": {
                      "type": "integer",
                      "example": 8
                    },
                    "relationshipsCreated": {
                      "type": "integer",
                      "example": 50
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - invalid JSON or missing required fields",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "invalid_request"
                    },
                    "message": {
                      "type": "string",
                      "example": "repositoryUrl is required"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "unauthenticated"
                    },
                    "message": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found - system with repository URL not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "system_not_found"
                    },
                    "message": {
                      "type": "string",
                      "example": "No system found with repository URL: https://github.com/org/repo. Please create the system first."
                    }
                  }
                }
              }
            }
          },
          "415": {
            "description": "Unsupported Media Type - Content-Type must be application/json",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "unsupported_media_type"
                    },
                    "required": {
                      "type": "string",
                      "example": "application/json"
                    }
                  }
                }
              }
            }
          },
          "422": {
            "description": "Unprocessable Entity - SBOM validation failed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "invalid_sbom"
                    },
                    "format": {
                      "type": "string",
                      "enum": [
                        "cyclonedx",
                        "spdx",
                        "unknown"
                      ]
                    },
                    "validationErrors": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "instancePath": {
                            "type": "string"
                          },
                          "message": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/systems": {
      "get": {
        "tags": [
          "Systems"
        ],
        "summary": "List all systems",
        "description": "Retrieves a list of all systems with their metadata, component counts, and repository counts",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved systems",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/System"
                          }
                        },
                        "total": {
                          "type": "integer",
                          "description": "Total number of systems"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch systems",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Systems"
        ],
        "summary": "Create a new system",
        "description": "Creates a new system with optional repositories",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "domain",
                  "ownerTeam",
                  "businessCriticality",
                  "environment"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Unique system name"
                  },
                  "domain": {
                    "type": "string",
                    "description": "Business domain"
                  },
                  "ownerTeam": {
                    "type": "string",
                    "description": "Team that owns this system"
                  },
                  "businessCriticality": {
                    "type": "string",
                    "enum": [
                      "critical",
                      "high",
                      "medium",
                      "low"
                    ],
                    "description": "Business criticality level"
                  },
                  "environment": {
                    "type": "string",
                    "enum": [
                      "dev",
                      "test",
                      "staging",
                      "prod"
                    ],
                    "description": "Environment type"
                  },
                  "repositories": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": [
                        "url",
                        "scmType",
                        "name",
                        "isPublic",
                        "requiresAuth"
                      ],
                      "properties": {
                        "url": {
                          "type": "string"
                        },
                        "scmType": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "isPublic": {
                          "type": "boolean"
                        },
                        "requiresAuth": {
                          "type": "boolean"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "System created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Missing required fields",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "System already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Invalid field values",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/systems/{name}": {
      "delete": {
        "tags": [
          "Systems"
        ],
        "summary": "Delete a system",
        "description": "Deletes a system and all its relationships (requires authorization and team ownership)",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "System name"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "responses": {
          "204": {
            "description": "System deleted successfully"
          },
          "400": {
            "description": "System name is required"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden - user's team does not own this system"
          },
          "404": {
            "description": "System not found"
          }
        }
      },
      "get": {
        "tags": [
          "Systems"
        ],
        "summary": "Get system by name",
        "description": "Retrieves detailed information about a specific system",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "System name"
          }
        ],
        "responses": {
          "200": {
            "description": "System found",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSingleResourceResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/System"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "System name is required"
          },
          "404": {
            "description": "System not found"
          }
        }
      },
      "patch": {
        "tags": [
          "Systems"
        ],
        "summary": "Partially update a system",
        "description": "Updates specific fields of a system. Only provided fields are updated.\n\n**Authorization:** Team Owner - User must belong to the team that owns the system\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "System name"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "description": {
                    "type": "string"
                  },
                  "businessCriticality": {
                    "type": "string",
                    "enum": [
                      "critical",
                      "high",
                      "medium",
                      "low"
                    ]
                  },
                  "environment": {
                    "type": "string",
                    "enum": [
                      "dev",
                      "test",
                      "staging",
                      "prod"
                    ]
                  }
                }
              },
              "example": {
                "description": "Customer-facing web portal",
                "businessCriticality": "critical",
                "environment": "prod"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "System updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiSuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "System name is required"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "User does not belong to team that owns this system"
          },
          "404": {
            "description": "System not found"
          },
          "422": {
            "description": "Validation error - invalid field values"
          }
        }
      },
      "put": {
        "tags": [
          "Systems"
        ],
        "summary": "Fully update/replace a system",
        "description": "Replaces all system fields. All required fields must be provided.\n\n**Authorization:** Team Owner - User must belong to the team that owns the system\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "System name"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "domain",
                  "ownerTeam",
                  "businessCriticality",
                  "environment"
                ],
                "properties": {
                  "domain": {
                    "type": "string"
                  },
                  "ownerTeam": {
                    "type": "string"
                  },
                  "businessCriticality": {
                    "type": "string",
                    "enum": [
                      "critical",
                      "high",
                      "medium",
                      "low"
                    ]
                  },
                  "environment": {
                    "type": "string",
                    "enum": [
                      "dev",
                      "test",
                      "staging",
                      "prod"
                    ]
                  },
                  "description": {
                    "type": "string"
                  }
                }
              },
              "example": {
                "domain": "customer-experience",
                "ownerTeam": "frontend-team",
                "businessCriticality": "critical",
                "environment": "prod",
                "description": "Customer-facing web portal"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "System updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiSuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "System name is required or missing required fields"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "User does not belong to team that owns this system"
          },
          "404": {
            "description": "System not found"
          },
          "422": {
            "description": "Validation error - invalid field values"
          }
        }
      }
    },
    "/api/systems/{name}/repositories": {
      "get": {
        "tags": [
          "Systems"
        ],
        "summary": "List repositories for a system",
        "description": "Returns all repositories linked to a system",
        "parameters": [
          {
            "name": "name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "System name"
          }
        ],
        "responses": {
          "200": {
            "description": "List of repositories",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Repository"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "System not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Systems"
        ],
        "summary": "Register a repository for a system",
        "description": "Links a repository to a system for SBOM tracking. Creates the repository if it doesn't exist.",
        "parameters": [
          {
            "name": "name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "System name"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "url"
                ],
                "properties": {
                  "url": {
                    "type": "string",
                    "format": "uri",
                    "description": "Repository URL",
                    "example": "https://github.com/org/repo"
                  },
                  "name": {
                    "type": "string",
                    "description": "Repository name (auto-extracted from URL if not provided)",
                    "example": "repo"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Repository registered successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/Repository"
                    },
                    "message": {
                      "type": "string",
                      "example": "Repository registered for system my-system"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "invalid_url"
                    },
                    "message": {
                      "type": "string",
                      "example": "Invalid repository URL"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "System not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "system_not_found"
                    },
                    "message": {
                      "type": "string",
                      "example": "System not found: my-system"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/systems/{name}/unmapped-components": {
      "get": {
        "tags": [
          "Systems"
        ],
        "summary": "Get unmapped components for a system",
        "description": "Retrieves all components used by a system that are not mapped to a known technology.\n\nThese components need manual review to determine if they should be:\n- Mapped to an existing technology\n- Added as a new technology\n- Marked as internal/proprietary\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "System name",
            "example": "web-portal"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Unmapped components retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/UnmappedComponent"
                      }
                    },
                    "count": {
                      "type": "integer",
                      "description": "Number of items in current page"
                    },
                    "total": {
                      "type": "integer",
                      "description": "Total number of unmapped components"
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": [
                    {
                      "name": "@company/internal-ui",
                      "version": "2.1.0",
                      "packageManager": "npm",
                      "license": "proprietary"
                    }
                  ],
                  "count": 1,
                  "total": 1
                }
              }
            }
          },
          "400": {
            "description": "System name is required"
          },
          "404": {
            "description": "System not found"
          },
          "500": {
            "description": "Failed to fetch unmapped components"
          }
        }
      }
    },
    "/teams": {
      "get": {
        "tags": [
          "Teams"
        ],
        "summary": "List all teams",
        "description": "Retrieves a list of all teams with their technology and system counts",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved teams",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Team"
                          }
                        },
                        "total": {
                          "type": "integer",
                          "description": "Total number of teams"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch teams",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Teams"
        ],
        "summary": "Create a new team",
        "description": "Creates a new team. Requires superuser access.",
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Unique team name"
                  },
                  "email": {
                    "type": "string",
                    "description": "Team contact email"
                  },
                  "responsibilityArea": {
                    "type": "string",
                    "description": "Area of responsibility"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Team created successfully"
          },
          "400": {
            "description": "Missing required fields"
          },
          "403": {
            "description": "Superuser access required"
          },
          "409": {
            "description": "Team already exists"
          }
        }
      }
    },
    "/teams/{name}": {
      "delete": {
        "tags": [
          "Teams"
        ],
        "summary": "Delete a team",
        "description": "Deletes a team and all its relationships. Requires superuser access.\n\n**Authorization:** Superuser\n\n**Business Rules:**\n- Team cannot be deleted if it owns any systems\n- All systems must be reassigned or deleted first\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Team name"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "responses": {
          "204": {
            "description": "Team deleted successfully"
          },
          "400": {
            "description": "Team name is required"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Superuser access required"
          },
          "404": {
            "description": "Team not found"
          },
          "409": {
            "description": "Cannot delete team that owns systems",
            "content": {
              "application/json": {
                "example": {
                  "statusCode": 409,
                  "message": "Cannot delete team 'frontend-team' because it owns 3 system(s). Please reassign or delete the systems first."
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Teams"
        ],
        "summary": "Get team details",
        "description": "Retrieves detailed information about a specific team including technology ownership, system ownership, and member count",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Team name",
            "example": "frontend-team"
          }
        ],
        "responses": {
          "200": {
            "description": "Team details retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSingleResourceResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "allOf": [
                            {
                              "$ref": "#/components/schemas/Team"
                            },
                            {
                              "type": "object",
                              "properties": {
                                "usedTechnologyCount": {
                                  "type": "integer"
                                },
                                "memberCount": {
                                  "type": "integer"
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": {
                    "name": "frontend-team",
                    "email": "frontend@example.com",
                    "responsibilityArea": "Web Applications",
                    "technologyCount": 15,
                    "systemCount": 8,
                    "usedTechnologyCount": 20,
                    "memberCount": 5
                  }
                }
              }
            }
          },
          "400": {
            "description": "Team name is required"
          },
          "404": {
            "description": "Team not found"
          }
        }
      },
      "put": {
        "tags": [
          "Teams"
        ],
        "summary": "Update a team",
        "description": "Updates a team's email and/or responsibility area. Requires superuser access.",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Team name"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "New team name (for renaming)"
                  },
                  "email": {
                    "type": "string"
                  },
                  "responsibilityArea": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Team updated successfully"
          },
          "400": {
            "description": "Team name is required"
          },
          "403": {
            "description": "Superuser access required"
          },
          "404": {
            "description": "Team not found"
          },
          "422": {
            "description": "At least one field to update is required"
          }
        }
      }
    },
    "/teams/{name}/approvals": {
      "get": {
        "tags": [
          "Teams"
        ],
        "summary": "Get team approvals",
        "description": "Retrieves all technology approvals for a specific team.\n\nReturns both technology-level and version-specific approvals with TIME framework values.\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Team name"
          }
        ],
        "responses": {
          "200": {
            "description": "Team approvals retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "team": {
                          "type": "string"
                        },
                        "approvals": {
                          "type": "array",
                          "items": {
                            "type": "object"
                          }
                        }
                      }
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "team": "frontend-team",
                    "approvals": [
                      {
                        "technology": "react",
                        "category": "framework",
                        "time": "adopt",
                        "approvedAt": "2024-01-15T10:00:00Z",
                        "approvedBy": "architecture-team",
                        "notes": "Approved for all new projects"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "description": "Team name is required"
          },
          "404": {
            "description": "Team not found"
          }
        }
      }
    },
    "/teams/{name}/policies": {
      "get": {
        "tags": [
          "Teams"
        ],
        "summary": "Get team policies",
        "description": "Retrieves policies enforced by and applicable to a specific team.\n\nReturns two categories:\n- **Enforced**: Policies this team is responsible for enforcing\n- **Subject To**: Policies that apply to this team\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Team name",
            "example": "frontend-team"
          }
        ],
        "responses": {
          "200": {
            "description": "Team policies retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "team": {
                          "type": "string"
                        },
                        "enforced": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Policy"
                          }
                        },
                        "subjectTo": {
                          "type": "array",
                          "items": {
                            "allOf": [
                              {
                                "$ref": "#/components/schemas/Policy"
                              },
                              {
                                "type": "object",
                                "properties": {
                                  "enforcedBy": {
                                    "type": "string"
                                  }
                                }
                              }
                            ]
                          }
                        },
                        "enforcedCount": {
                          "type": "integer"
                        },
                        "subjectToCount": {
                          "type": "integer"
                        }
                      }
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "team": "frontend-team",
                    "enforced": [
                      {
                        "name": "react-version-policy",
                        "description": "All React versions must be 18.x or higher",
                        "ruleType": "version-constraint",
                        "severity": "high",
                        "status": "active"
                      }
                    ],
                    "subjectTo": [
                      {
                        "name": "security-scanning-policy",
                        "description": "All systems must have security scanning enabled",
                        "ruleType": "security",
                        "severity": "critical",
                        "status": "active",
                        "enforcedBy": "security-team"
                      }
                    ],
                    "enforcedCount": 1,
                    "subjectToCount": 1
                  }
                }
              }
            }
          },
          "400": {
            "description": "Team name is required"
          },
          "500": {
            "description": "Failed to fetch team policies"
          }
        }
      }
    },
    "/teams/{name}/usage": {
      "get": {
        "tags": [
          "Teams"
        ],
        "summary": "Get team technology usage",
        "description": "Retrieves all technologies used by a team with usage statistics and compliance status.\n\n**Compliance Status:**\n- `compliant`: Technology is approved (invest/tolerate)\n- `unapproved`: No approval exists\n- `migration-needed`: Technology is marked for migration\n- `violation`: Technology is marked for elimination\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Team name",
            "example": "frontend-team"
          }
        ],
        "responses": {
          "200": {
            "description": "Team usage retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "team": {
                          "type": "string"
                        },
                        "usage": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "technology": {
                                "type": "string"
                              },
                              "category": {
                                "type": "string"
                              },
                              "vendor": {
                                "type": "string"
                              },
                              "systemCount": {
                                "type": "integer"
                              },
                              "firstUsed": {
                                "type": "string",
                                "format": "date"
                              },
                              "lastVerified": {
                                "type": "string",
                                "format": "date"
                              },
                              "approvalStatus": {
                                "type": "string",
                                "enum": [
                                  "invest",
                                  "tolerate",
                                  "migrate",
                                  "eliminate"
                                ]
                              },
                              "complianceStatus": {
                                "type": "string",
                                "enum": [
                                  "compliant",
                                  "unapproved",
                                  "migration-needed",
                                  "violation",
                                  "unknown"
                                ]
                              }
                            }
                          }
                        },
                        "summary": {
                          "type": "object",
                          "properties": {
                            "totalTechnologies": {
                              "type": "integer"
                            },
                            "compliant": {
                              "type": "integer"
                            },
                            "unapproved": {
                              "type": "integer"
                            },
                            "violations": {
                              "type": "integer"
                            },
                            "migrationNeeded": {
                              "type": "integer"
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "example": {
                  "success": true,
                  "data": {
                    "team": "frontend-team",
                    "usage": [
                      {
                        "technology": "React",
                        "category": "framework",
                        "vendor": "Meta",
                        "systemCount": 8,
                        "firstUsed": "2023-01-15",
                        "lastVerified": "2025-10-20",
                        "approvalStatus": "invest",
                        "complianceStatus": "compliant"
                      }
                    ],
                    "summary": {
                      "totalTechnologies": 15,
                      "compliant": 12,
                      "unapproved": 2,
                      "violations": 0,
                      "migrationNeeded": 1
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Team name is required"
          },
          "500": {
            "description": "Failed to fetch team usage"
          }
        }
      }
    },
    "/technologies": {
      "get": {
        "tags": [
          "Technologies"
        ],
        "summary": "List all technologies",
        "description": "Retrieves a list of all technologies with their versions and approvals",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved technologies",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSuccessResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Technology"
                          }
                        },
                        "total": {
                          "type": "integer",
                          "description": "Total number of technologies"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to fetch technologies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Technologies"
        ],
        "summary": "Create a new technology",
        "description": "Creates a new technology entry, optionally linking it to a source component",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "category"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Unique technology name"
                  },
                  "category": {
                    "type": "string",
                    "enum": [
                      "language",
                      "framework",
                      "library",
                      "database",
                      "platform",
                      "tool",
                      "runtime",
                      "other"
                    ]
                  },
                  "vendor": {
                    "type": "string"
                  },
                  "ownerTeam": {
                    "type": "string"
                  },
                  "componentName": {
                    "type": "string",
                    "description": "Component name  all versions with this name and packageManager will be linked"
                  },
                  "componentPackageManager": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Technology created"
          },
          "400": {
            "description": "Missing required fields"
          },
          "409": {
            "description": "Technology already exists"
          },
          "422": {
            "description": "Invalid field values"
          }
        }
      }
    },
    "/technologies/{name}": {
      "delete": {
        "tags": [
          "Technologies"
        ],
        "summary": "Delete a technology",
        "description": "Deletes a technology and all its relationships. Requires superuser role or membership in the technology's owner team.",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Technology name"
          }
        ],
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "responses": {
          "204": {
            "description": "Technology deleted"
          },
          "400": {
            "description": "Technology name is required"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden - user is not a superuser and does not belong to the owner team"
          },
          "404": {
            "description": "Technology not found"
          }
        }
      },
      "get": {
        "tags": [
          "Technologies"
        ],
        "summary": "Get technology details",
        "description": "Retrieves detailed information about a specific technology including versions, components, systems, policies, and approvals.\n\nReturns comprehensive data about:\n- Technology metadata (category, vendor, risk level)\n- All versions with release and EOL dates\n- Components using this technology\n- Systems that depend on it\n- Applicable policies\n- Technology-level and version-specific approvals\n",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Technology name (e.g., \"React\", \"PostgreSQL\")",
            "example": "React"
          }
        ],
        "responses": {
          "200": {
            "description": "Technology details retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiSingleResourceResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "allOf": [
                            {
                              "$ref": "#/components/schemas/Technology"
                            },
                            {
                              "type": "object",
                              "properties": {
                                "ownerTeamEmail": {
                                  "type": "string"
                                },
                                "components": {
                                  "type": "array",
                                  "items": {
                                    "type": "object"
                                  }
                                },
                                "systems": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                },
                                "policies": {
                                  "type": "array",
                                  "items": {
                                    "type": "object"
                                  }
                                },
                                "versionApprovals": {
                                  "type": "array",
                                  "items": {
                                    "type": "object"
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": {
                    "name": "React",
                    "category": "framework",
                    "vendor": "Meta",
                    "lastReviewed": "2025-10-01",
                    "ownerTeamName": "Frontend Platform",
                    "ownerTeamEmail": "frontend-platform@company.com",
                    "versions": [
                      "18.2.0",
                      "18.3.1"
                    ],
                    "technologyApprovals": [
                      {
                        "team": "Frontend Platform",
                        "time": "invest",
                        "approvedAt": "2025-10-21T19:23:55.763Z",
                        "approvedBy": "Frontend Lead",
                        "notes": "Primary framework for customer-facing applications"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "description": "Technology name is required"
          },
          "404": {
            "description": "Technology not found"
          },
          "500": {
            "description": "Failed to fetch technology"
          }
        }
      },
      "put": {
        "tags": [
          "Technologies"
        ],
        "summary": "Update a technology",
        "description": "Updates a technology's properties and ownership. Requires superuser role or membership in the technology's owner team.",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Technology name"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "category"
                ],
                "properties": {
                  "category": {
                    "type": "string"
                  },
                  "vendor": {
                    "type": "string"
                  },
                  "ownerTeam": {
                    "type": "string"
                  },
                  "lastReviewed": {
                    "type": "string",
                    "format": "date"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Technology updated"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Technology not found"
          },
          "422": {
            "description": "Validation error"
          }
        }
      }
    },
    "/technologies/{name}/approvals": {
      "post": {
        "tags": [
          "Technologies"
        ],
        "summary": "Set a team's TIME approval for a technology",
        "description": "Creates or updates a team's APPROVES relationship on a technology. The user must be a member of the specified team or a superuser.",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Technology name"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "teamName",
                  "time"
                ],
                "properties": {
                  "teamName": {
                    "type": "string"
                  },
                  "time": {
                    "type": "string",
                    "enum": [
                      "tolerate",
                      "invest",
                      "migrate",
                      "eliminate"
                    ]
                  },
                  "versionConstraint": {
                    "type": "string"
                  },
                  "notes": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Approval set"
          },
          "400": {
            "description": "Missing required fields"
          },
          "403": {
            "description": "User is not a member of the specified team"
          },
          "404": {
            "description": "Technology not found"
          },
          "422": {
            "description": "Invalid TIME value"
          }
        }
      }
    },
    "/users/{id}": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Get user details",
        "description": "Returns full user details including teams, tokens (technical users), and recent audit activity. Superuser only.",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User details"
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },
    "/users": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "List all users (superuser only)",
        "description": "Retrieves a list of all users with their team counts (requires superuser role)",
        "security": [
          {
            "sessionAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of results per page"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved users",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "allOf": [
                          {
                            "$ref": "#/components/schemas/User"
                          },
                          {
                            "type": "object",
                            "properties": {
                              "teamCount": {
                                "type": "integer"
                              }
                            }
                          }
                        ]
                      }
                    },
                    "count": {
                      "type": "integer",
                      "description": "Number of items in current page"
                    },
                    "total": {
                      "type": "integer",
                      "description": "Total number of items"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - superuser access required"
          },
          "500": {
            "description": "Failed to fetch users"
          }
        }
      }
    }
  }
}