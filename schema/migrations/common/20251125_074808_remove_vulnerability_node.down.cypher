/*
 * Rollback: Restore Vulnerability Node
 * 
 * Recreates the Vulnerability node type with constraints and indexes.
 * Note: This does not restore any vulnerability data that was deleted.
 */

// Create Vulnerability node constraint
CREATE CONSTRAINT vulnerability_id_unique IF NOT EXISTS
FOR (v:Vulnerability) REQUIRE v.id IS UNIQUE;

// Create indexes for common queries
CREATE INDEX vulnerability_severity IF NOT EXISTS
FOR (v:Vulnerability) ON (v.severity);

CREATE INDEX vulnerability_published_date IF NOT EXISTS
FOR (v:Vulnerability) ON (v.publishedDate);

CREATE INDEX vulnerability_cvss_score IF NOT EXISTS
FOR (v:Vulnerability) ON (v.cvssScore);

// Vulnerability properties:
// - id: string (CVE, GHSA, OSV, etc.)
// - source: string (NVD, GitHub Security Advisories, OSV database)
// - description: string
// - severity: string (critical, high, medium, low)
// - cvssScore: float (0-10 scale)
// - publishedDate: datetime
// - lastModifiedDate: datetime
// - references: list of strings (URLs)
// - analysisState: string (exploitable, in_triage, false_positive, not_affected)

// Note: Relationships like HAS_VULNERABILITY would need to be recreated separately
