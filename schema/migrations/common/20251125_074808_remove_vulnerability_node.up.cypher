/*
 * Migration: Remove Vulnerability Node
 * Version: 2025.11.25.074808
 * Author: @ona
 * 
 * Description:
 * Removes the Vulnerability node type and all related constraints and indexes.
 * Polaris does not manage vulnerabilities directly - vulnerability management
 * should be handled by dedicated security scanning tools.
 *
 * Dependencies:
 * - None
 *
 * Rollback: See corresponding .down.cypher file
 */

// Drop indexes for Vulnerability node
DROP INDEX vulnerability_severity IF EXISTS;
DROP INDEX vulnerability_published_date IF EXISTS;
DROP INDEX vulnerability_cvss_score IF EXISTS;

// Drop constraint for Vulnerability node
DROP CONSTRAINT vulnerability_id_unique IF EXISTS;

// Delete all Vulnerability nodes and their relationships
MATCH (v:Vulnerability)
DETACH DELETE v;
